define(["backbone","underscore","jquery","collections/groups","collections/statusMessages","views/groupList","views/statusList","views/LoadingIndicator"],function(e,t,n,r,i,s,o,u){var a=e.Router.extend({routes:{"":"home",groups:"groups","groups/:id":"groupsFeed","groups/:id/from/:from/to/:to":"dateFilteredFeed"},_preHook:function(){s.unrender(),o.unrender(),i.reset(null,{silent:!0})},home:function(){window.location.hash="groups"},groups:function(){this._preHook();if(r.length>0)return s.render(r),!0;this._queryFbGraph("https://graph.facebook.com/v2.3/me/groups?access_token="+this._getToken()+"&callback=?",r,s)},dateFilteredFeed:function(e,t,n){i.length<0&&(window.location.hash="groups");var r=i.filterDateBetween(t,n);o.unrenderCollection(),o.renderCollection(r)},groupsFeed:function(e){this._preHook(),o.renderForm(i),this._queryFbGraph("https://graph.facebook.com/v2.3/"+e+"/feed?access_token="+this._getToken()+"&limit=500&callback=?",i,o)},_getToken:function(){return n("meta[name=oauth_token]").attr("content")},_queryFbGraph:function(e,t,r,i){var s=this;n.getJSON(e,function(e){e.data&&e.data.length>0&&t.add(e.data,{silent:!0});if(e.paging&&e.paging.next){var n=e.paging.next.split("&");n.push("callback=?");var i=n.join("&");s._queryFbGraph(i,t,r)}else r.render(t),u.hide()})}});return a});